<%= @student.name %>
<%= link_to "Charts", chart_student_path %>
<div id="problems_history" class="teacher-details-header" style="margin-bottom:5px;"></div>
<div class="row">
  	<div class="span4" id="chapterspan4">
		<div class="column-listheader">
	  		Chapters
		</div>
		<div class='column-listdiv'>
	  		<ul class='column-list2' id="chapter_tabs">
				<% @problem_sets.each do |pset| %>
					<% pset.problem_types.each do |ptype|%>
						<% @array = [['Problem Types','Correct Percentage']] %>
						<% @answers = ptype.answers.map(&:correct) %>
						<% @ans_right = @answers.select{|v| v == true}.count %>
  						<% @ans_wrong = @answers.select{|v| v == true}.count %>
  						<% if (@ans_wrong + @ans_right) > 0 %>  
  		  					<% @array.push([ptype.name, (@ans_right * 100) / (@ans_right + @ans_wrong)]) %>
  						<% end %>  
  					<% end %> 
		  			<li><%= link_to pset.name, "#chap_#{pset.id}", :"data-toggle" => "tab" %></li>
				<% end %>
	  		</ul>
		</div>
  	</div>
	<div class="span4" id="tryspan4">
		<div class="tab-content">
	  		<% @problem_sets.each do |pset| %>
				<div class="tab-pane" id="chap_<%= pset.id %>">
		  			<div class="column-listheader">
						Problem Types
		  			</div>
		  			<div class="column-listdiv">
						<ul class='column-list2 column-list22' id="column_list">
			  				<% pset.problem_types.each do |ptype| %>
			  					<% @count = 0%>
			  					<% @counttrue = 0%>
		  						<% ptype.answers.each do |answer|%>
                                	<% @count = @count? @count+ 1: 0%>
                                	<%if answer.correct == true%>
                                		<% @counttrue = @counttrue ? @counttrue +1 :0%>
                                	<%end%>
		  						<% end %>
		  						<li><%= link_to (ptype.name), "#chap_#{pset.id}_#{ptype.id}", :"data-toggle" => "tab" %> 
		  							<span style="float:right;"><%= ( @counttrue.to_s + "/" +@count.to_s)%></span></li>
							<% end %>
						</ul>
		  			</div>     
				</div>
				<div class="tab-pane" id="chap">
					<div class="dotted-border-header-black">
						Problem Types 2
		  			</div>
				</div>
	  		<% end %>
		</div>
  	</div>
	<div class="span4" id="histspan4">
   		<div class="tab-content">
			<% @problem_sets.each do |pset| %>
				<% pset.problem_types.each do |ptype|%>
					<div class="tab-pane" id="chap_<%= pset.id %>_<%= ptype.id%>">
	  					<!-- <div class='dotted-border-header'> -->
	  					<div class="column-listheader">
							<h4>History</h4>
	  					</div>
	  					<!-- <div class='dotted-border' style='min-height:400px;'> -->
	  					<div class="column-listdiv" style="min-height:400px;">
							<ul class='column-list2 colum-list22' id="History_tabs">
		  						<% ptype.answers.each do |answer| %>
		  							<% if answer.user_id == @student.id %>
		  								<%if answer.correct == true%>
											<li><%= link_to (answer.problem_type.to_s), show_answer_path(id: answer.id, instance: pset.id), remote: true %><span style="float:right;"><%= image_tag "correct_check.jpg"%></span>
											</li>	
										<% else %>		
											<li><%= link_to (answer.problem_type.to_s), show_answer_path(id: answer.id, instance: pset.id), remote: true %><span style="float:right;"><%= image_tag "incorrect_x.jpg"%></span>
										<% end %>
											</li>
		  							<% end %>
	  							<% end %>
							</ul>
						</div>
					</div>
				<% end %>
			<% end %>
  		</div>
	</div>
</div>
<div class = "span12" id = "pset_chart">
 	<div id="chart_div_2_pset" style="width: 900px; height: 500px;"></div>
</div> 

<!-- Student Performance chart by each problem_types correct percentage -->
<%= render "shared/google_visual_barchart", :array => @array, :div => "chart_div_2_pset", :title => "Student Performance", :vAxis_title => "Problem Types"  %>
<div id="chart_div_2_pset" style="width: 900px; height: 500px;"></div>
<!-- Chart ends -->

<script>
	$("#chapter_tabs li a").click(function(){
		$("#histspan4").hide();
		$('#chapterspan4').css("margin-right","0%");
		$('#chapterspan4').animate({marginRight:"7%"},"fast","swing");
	});
	$("#tryspan4 li a").click(function(){
		$('#histspan4').show();
		$('#histspan4').css("margin-left","0%");
		$('#histspan4').animate({marginLeft:"7%"},"fast","swing");
	});
</script>
